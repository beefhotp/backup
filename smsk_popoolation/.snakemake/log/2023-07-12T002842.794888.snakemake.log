Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 1 (use --cores to define parallelism)
Rules claiming more threads will be scaled down.
Singularity containers: ignored
Job stats:
job                                    count    min threads    max threads
-----------------------------------  -------  -------------  -------------
all                                        1              1              1
decompress                                 2              1              1
fst_merge                                  1              1              1
fst_plot                                   1              1              1
fst_sliding                                1              1              1
fst_split_table                            1              1              1
hp_plot_population                         2              1              1
hp_table_population_chromosome             2              1              1
index_cram                                 3              1              1
index_fasta                                1              1              1
map_bwa_index                              1              1              1
map_bwa_map                                3              1              1
map_filter                                 3              1              1
map_split                                  3              1              1
mpileup_convert                            2              1              1
mpileup_popoolation_filter_indels          2              1              1
mpileup_popoolation_identify_indels        2              1              1
mpileup_popoolation_subsample              2              1              1
popoolation_merge_snps                     2              1              1
popoolation_merge_variance_sliding         6              1              1
popoolation_plot                           6              1              1
popoolation_variance_sliding               6              1              1
qc_trimmomatic                             3              1              1
raw_extract_genome                         1              1              1
raw_make_links_pe                          2              1              1
reports_samtools_flagstat                  3              1              1
reports_samtools_idxstats                  3              1              1
reports_samtools_stats                     3              1              1
sync_filter_indels                         1              1              1
sync_identify_indels                       1              1              1
sync_mpileup2sync                          1              1              1
sync_subsample                             1              1              1
total                                     72              1              1

Select jobs to execute...

[Wed Jul 12 00:28:47 2023]
rule qc_trimmomatic:
    input: results/raw/pop1.lib1_1.fq, results/raw/pop1.lib1_2.fq
    output: results/qc/pop1.lib1_1.fq, results/qc/pop1.lib1_2.fq, results/qc/pop1.lib1_3.fq, results/qc/pop1.lib1_4.fq
    log: results/qc/pop1.lib1.trimmomatic_pe.log
    jobid: 10
    benchmark: results/qc/pop1.lib1.trimmomatic_pe.json
    reason: Missing output files: results/qc/pop1.lib1_2.fq, results/qc/pop1.lib1_3.fq, results/qc/pop1.lib1_1.fq, results/qc/pop1.lib1_4.fq
    wildcards: population=pop1, library=lib1
    priority: 50
    resources: tmpdir=/tmp


        trimmomatic PE \
            -threads 1 \
            -phred33 \
            results/raw/pop1.lib1_1.fq results/raw/pop1.lib1_2.fq \
            results/qc/pop1.lib1_1.fq results/qc/pop1.lib1_3.fq results/qc/pop1.lib1_2.fq results/qc/pop1.lib1_4.fq \
            ILLUMINACLIP:data/adapters/TruSeq3-PE-2.fa:2:30:10 \
            AVGQUAL:3 MINLEN:31 LEADING:19 TRAILING:19 MINLEN:31 SLIDINGWINDOW:4:5 LEADING:5 TRAILING:5 MINLEN:25 TOPHRED33 \
            2> results/qc/pop1.lib1.trimmomatic_pe.log 1>&2
        
Activating conda environment: qc
[Wed Jul 12 00:28:53 2023]
Finished job 10.
1 of 72 steps (1%) done
Select jobs to execute...

[Wed Jul 12 00:28:53 2023]
rule raw_make_links_pe:
    input: data/reads/pop2_1.fq.gz, data/reads/pop2_2.fq.gz
    output: results/raw/pop2.lib1_1.fq.gz, results/raw/pop2.lib1_2.fq.gz
    jobid: 36
    reason: Missing output files: results/raw/pop2.lib1_2.fq.gz, results/raw/pop2.lib1_1.fq.gz
    wildcards: population=pop2, library=lib1
    resources: tmpdir=/tmp


        ln --symbolic $(readlink --canonicalize data/reads/pop2_1.fq.gz) results/raw/pop2.lib1_1.fq.gz
        ln --symbolic $(readlink --canonicalize data/reads/pop2_2.fq.gz) results/raw/pop2.lib1_2.fq.gz
        
[Wed Jul 12 00:28:53 2023]
Finished job 36.
2 of 72 steps (3%) done
Select jobs to execute...

[Wed Jul 12 00:28:53 2023]
rule raw_make_links_pe:
    input: data/reads/pop1_1.fq.gz, data/reads/pop1_2.fq.gz
    output: results/raw/pop1.lib2_1.fq.gz, results/raw/pop1.lib2_2.fq.gz
    jobid: 21
    reason: Missing output files: results/raw/pop1.lib2_1.fq.gz, results/raw/pop1.lib2_2.fq.gz
    wildcards: population=pop1, library=lib2
    resources: tmpdir=/tmp


        ln --symbolic $(readlink --canonicalize data/reads/pop1_1.fq.gz) results/raw/pop1.lib2_1.fq.gz
        ln --symbolic $(readlink --canonicalize data/reads/pop1_2.fq.gz) results/raw/pop1.lib2_2.fq.gz
        
[Wed Jul 12 00:28:53 2023]
Finished job 21.
3 of 72 steps (4%) done
Select jobs to execute...

[Wed Jul 12 00:28:53 2023]
rule decompress:
    input: results/raw/pop1.lib2_1.fq.gz, results/raw/pop1.lib2_2.fq.gz
    output: results/raw/pop1.lib2_1.fq, results/raw/pop1.lib2_2.fq
    jobid: 20
    reason: Missing output files: results/raw/pop1.lib2_2.fq, results/raw/pop1.lib2_1.fq; Input files updated by another job: results/raw/pop1.lib2_1.fq.gz, results/raw/pop1.lib2_2.fq.gz
    wildcards: population=pop1, library=lib2
    resources: tmpdir=/tmp


        gzip --decompress --stdout results/raw/pop1.lib2_1.fq.gz > results/raw/pop1.lib2_1.fq
        gzip --decompress --stdout results/raw/pop1.lib2_2.fq.gz > results/raw/pop1.lib2_2.fq
        
[Wed Jul 12 00:28:54 2023]
Finished job 20.
4 of 72 steps (6%) done
Select jobs to execute...

[Wed Jul 12 00:28:54 2023]
rule qc_trimmomatic:
    input: results/raw/pop1.lib2_1.fq, results/raw/pop1.lib2_2.fq
    output: results/qc/pop1.lib2_1.fq, results/qc/pop1.lib2_2.fq, results/qc/pop1.lib2_3.fq, results/qc/pop1.lib2_4.fq
    log: results/qc/pop1.lib2.trimmomatic_pe.log
    jobid: 19
    benchmark: results/qc/pop1.lib2.trimmomatic_pe.json
    reason: Missing output files: results/qc/pop1.lib2_3.fq, results/qc/pop1.lib2_2.fq, results/qc/pop1.lib2_1.fq, results/qc/pop1.lib2_4.fq; Input files updated by another job: results/raw/pop1.lib2_2.fq, results/raw/pop1.lib2_1.fq; Code has changed since last execution; Software environment definition has changed since last execution
    wildcards: population=pop1, library=lib2
    priority: 50
    resources: tmpdir=/tmp


        trimmomatic PE \
            -threads 1 \
            -phred33 \
            results/raw/pop1.lib2_1.fq results/raw/pop1.lib2_2.fq \
            results/qc/pop1.lib2_1.fq results/qc/pop1.lib2_3.fq results/qc/pop1.lib2_2.fq results/qc/pop1.lib2_4.fq \
            ILLUMINACLIP:data/adapters/TruSeq3-PE-2.fa:2:30:10 \
            AVGQUAL:3 MINLEN:31 LEADING:19 TRAILING:19 MINLEN:31 SLIDINGWINDOW:4:5 LEADING:5 TRAILING:5 MINLEN:25 TOPHRED33 \
            2> results/qc/pop1.lib2.trimmomatic_pe.log 1>&2
        
Activating conda environment: qc
[Wed Jul 12 00:28:59 2023]
Finished job 19.
5 of 72 steps (7%) done
Select jobs to execute...

[Wed Jul 12 00:28:59 2023]
rule raw_extract_genome:
    input: data/genome/2R.fa.gz
    output: results/raw/genome.fa
    log: results/raw/genome.log
    jobid: 14
    benchmark: results/raw/genome.json
    reason: Missing output files: results/raw/genome.fa
    resources: tmpdir=/tmp

gzip --decompress --stdout data/genome/2R.fa.gz > results/raw/genome.fa 2> results/raw/genome.log
[Wed Jul 12 00:28:59 2023]
Finished job 14.
6 of 72 steps (8%) done
Select jobs to execute...

[Wed Jul 12 00:28:59 2023]
rule map_bwa_index:
    input: results/raw/genome.fa
    output: results/index/genome, results/index/genome.amb, results/index/genome.ann, results/index/genome.bwt, results/index/genome.pac, results/index/genome.sa
    log: results/index/bwa_index.log
    jobid: 13
    benchmark: results/index/bwa_index.json
    reason: Missing output files: results/index/genome; Input files updated by another job: results/raw/genome.fa
    resources: tmpdir=/tmp

bwa index -p results/index/genome results/raw/genome.fa > results/index/bwa_index.log 2>&1
Activating conda environment: map
Touching output file results/index/genome.
[Wed Jul 12 00:28:59 2023]
Finished job 13.
7 of 72 steps (10%) done
Select jobs to execute...

[Wed Jul 12 00:28:59 2023]
rule map_bwa_map:
    input: results/qc/pop1.lib1_1.fq, results/qc/pop1.lib1_2.fq, results/qc/pop1.lib1_3.fq, results/qc/pop1.lib1_4.fq, results/index/genome, results/raw/genome.fa
    output: results/map/raw/pop1.lib1.cram
    log: results/map/raw/pop1.lib1.bwa_mem.log
    jobid: 9
    benchmark: results/map/raw/pop1.lib1.bwa_mem.json
    reason: Missing output files: results/map/raw/pop1.lib1.cram; Input files updated by another job: results/qc/pop1.lib1_2.fq, results/index/genome, results/qc/pop1.lib1_4.fq, results/qc/pop1.lib1_3.fq, results/qc/pop1.lib1_1.fq, results/raw/genome.fa
    wildcards: population=pop1, library=lib1
    resources: tmpdir=/tmp


        (bwa mem             -M             -R '@RG	ID:pop1_lib1	LB:truseq_lib1	PL:Illumina	SM:pop1'             -t 1                          results/index/genome             results/qc/pop1.lib1_1.fq             results/qc/pop1.lib1_2.fq         | samtools sort             -l 9             -o results/map/raw/pop1.lib1.cram             --reference results/raw/genome.fa             --output-fmt CRAM             -@ 1             /dev/stdin         ) 2> results/map/raw/pop1.lib1.bwa_mem.log
        
Activating conda environment: map
Write-protecting output file results/map/raw/pop1.lib1.cram.
[Wed Jul 12 00:29:27 2023]
Finished job 9.
8 of 72 steps (11%) done
Removing temporary output results/qc/pop1.lib1_2.fq.
Removing temporary output results/qc/pop1.lib1_3.fq.
Removing temporary output results/qc/pop1.lib1_1.fq.
Removing temporary output results/qc/pop1.lib1_4.fq.
Select jobs to execute...

[Wed Jul 12 00:29:27 2023]
rule map_bwa_map:
    input: results/qc/pop1.lib2_1.fq, results/qc/pop1.lib2_2.fq, results/qc/pop1.lib2_3.fq, results/qc/pop1.lib2_4.fq, results/index/genome, results/raw/genome.fa
    output: results/map/raw/pop1.lib2.cram
    log: results/map/raw/pop1.lib2.bwa_mem.log
    jobid: 18
    benchmark: results/map/raw/pop1.lib2.bwa_mem.json
    reason: Missing output files: results/map/raw/pop1.lib2.cram; Input files updated by another job: results/qc/pop1.lib2_3.fq, results/qc/pop1.lib2_4.fq, results/index/genome, results/qc/pop1.lib2_2.fq, results/raw/genome.fa, results/qc/pop1.lib2_1.fq
    wildcards: population=pop1, library=lib2
    resources: tmpdir=/tmp


        (bwa mem             -M             -R '@RG	ID:pop1_lib2	LB:truseq_lib2	PL:Illumina	SM:pop1'             -t 1                          results/index/genome             results/qc/pop1.lib2_1.fq             results/qc/pop1.lib2_2.fq         | samtools sort             -l 9             -o results/map/raw/pop1.lib2.cram             --reference results/raw/genome.fa             --output-fmt CRAM             -@ 1             /dev/stdin         ) 2> results/map/raw/pop1.lib2.bwa_mem.log
        
Activating conda environment: map
Write-protecting output file results/map/raw/pop1.lib2.cram.
[Wed Jul 12 00:29:54 2023]
Finished job 18.
9 of 72 steps (12%) done
Removing temporary output results/qc/pop1.lib2_3.fq.
Removing temporary output results/qc/pop1.lib2_2.fq.
Removing temporary output results/qc/pop1.lib2_1.fq.
Removing temporary output results/qc/pop1.lib2_4.fq.
Select jobs to execute...

[Wed Jul 12 00:29:54 2023]
rule reports_samtools_flagstat:
    input: results/map/raw/pop1.lib1.cram
    output: results/map/raw/pop1.lib1.flagstat.txt
    log: results/map/raw/pop1.lib1.flagstat.log
    jobid: 66
    benchmark: results/map/raw/pop1.lib1.flagstat.bmk
    reason: Missing output files: results/map/raw/pop1.lib1.flagstat.txt; Input files updated by another job: results/map/raw/pop1.lib1.cram
    wildcards: filename=results/map/raw/pop1.lib1
    resources: tmpdir=/tmp

samtools flagstat results/map/raw/pop1.lib1.cram > results/map/raw/pop1.lib1.flagstat.txt 2> results/map/raw/pop1.lib1.flagstat.log
Activating conda environment: reports
[Wed Jul 12 00:29:57 2023]
Finished job 66.
10 of 72 steps (14%) done
Select jobs to execute...

[Wed Jul 12 00:29:57 2023]
rule index_fasta:
    input: results/raw/genome.fa
    output: results/raw/genome.fa.fai
    jobid: 23
    reason: Missing output files: results/raw/genome.fa.fai; Input files updated by another job: results/raw/genome.fa
    wildcards: filename=results/raw/genome.fa
    resources: tmpdir=/tmp

samtools faidx results/raw/genome.fa
Warning: the following output files of rule index_fasta were not present when the DAG was created:
{'results/raw/genome.fa.fai'}
Activating conda environment: generic
[Wed Jul 12 00:29:58 2023]
Finished job 23.
11 of 72 steps (15%) done
Select jobs to execute...

[Wed Jul 12 00:29:58 2023]
rule reports_samtools_stats:
    input: results/map/raw/pop1.lib1.cram
    output: results/map/raw/pop1.lib1.stats.tsv
    log: results/map/raw/pop1.lib1.stats.log
    jobid: 65
    benchmark: results/map/raw/pop1.lib1.stats.bmk
    reason: Missing output files: results/map/raw/pop1.lib1.stats.tsv; Input files updated by another job: results/map/raw/pop1.lib1.cram
    wildcards: filename=results/map/raw/pop1.lib1
    resources: tmpdir=/tmp

samtools stats results/map/raw/pop1.lib1.cram > results/map/raw/pop1.lib1.stats.tsv 2>&1
Activating conda environment: reports
[Wed Jul 12 00:30:02 2023]
Finished job 65.
12 of 72 steps (17%) done
Select jobs to execute...

[Wed Jul 12 00:30:02 2023]
rule decompress:
    input: results/raw/pop2.lib1_1.fq.gz, results/raw/pop2.lib1_2.fq.gz
    output: results/raw/pop2.lib1_1.fq, results/raw/pop2.lib1_2.fq
    jobid: 35
    reason: Missing output files: results/raw/pop2.lib1_2.fq, results/raw/pop2.lib1_1.fq; Input files updated by another job: results/raw/pop2.lib1_2.fq.gz, results/raw/pop2.lib1_1.fq.gz
    wildcards: population=pop2, library=lib1
    resources: tmpdir=/tmp


        gzip --decompress --stdout results/raw/pop2.lib1_1.fq.gz > results/raw/pop2.lib1_1.fq
        gzip --decompress --stdout results/raw/pop2.lib1_2.fq.gz > results/raw/pop2.lib1_2.fq
        
[Wed Jul 12 00:30:03 2023]
Finished job 35.
13 of 72 steps (18%) done
Select jobs to execute...

[Wed Jul 12 00:30:03 2023]
rule qc_trimmomatic:
    input: results/raw/pop2.lib1_1.fq, results/raw/pop2.lib1_2.fq
    output: results/qc/pop2.lib1_1.fq, results/qc/pop2.lib1_2.fq, results/qc/pop2.lib1_3.fq, results/qc/pop2.lib1_4.fq
    log: results/qc/pop2.lib1.trimmomatic_pe.log
    jobid: 34
    benchmark: results/qc/pop2.lib1.trimmomatic_pe.json
    reason: Missing output files: results/qc/pop2.lib1_1.fq, results/qc/pop2.lib1_2.fq, results/qc/pop2.lib1_4.fq, results/qc/pop2.lib1_3.fq; Input files updated by another job: results/raw/pop2.lib1_2.fq, results/raw/pop2.lib1_1.fq; Code has changed since last execution
    wildcards: population=pop2, library=lib1
    priority: 50
    resources: tmpdir=/tmp


        trimmomatic PE \
            -threads 1 \
            -phred33 \
            results/raw/pop2.lib1_1.fq results/raw/pop2.lib1_2.fq \
            results/qc/pop2.lib1_1.fq results/qc/pop2.lib1_3.fq results/qc/pop2.lib1_2.fq results/qc/pop2.lib1_4.fq \
            ILLUMINACLIP:data/adapters/TruSeq3-PE-2.fa:2:30:10 \
            AVGQUAL:3 MINLEN:31 LEADING:19 TRAILING:19 MINLEN:31 SLIDINGWINDOW:4:5 LEADING:5 TRAILING:5 MINLEN:25 TOPHRED33 \
            2> results/qc/pop2.lib1.trimmomatic_pe.log 1>&2
        
Activating conda environment: qc
[Wed Jul 12 00:30:09 2023]
Finished job 34.
14 of 72 steps (19%) done
Select jobs to execute...

[Wed Jul 12 00:30:09 2023]
rule map_bwa_map:
    input: results/qc/pop2.lib1_1.fq, results/qc/pop2.lib1_2.fq, results/qc/pop2.lib1_3.fq, results/qc/pop2.lib1_4.fq, results/index/genome, results/raw/genome.fa
    output: results/map/raw/pop2.lib1.cram
    log: results/map/raw/pop2.lib1.bwa_mem.log
    jobid: 33
    benchmark: results/map/raw/pop2.lib1.bwa_mem.json
    reason: Missing output files: results/map/raw/pop2.lib1.cram; Input files updated by another job: results/qc/pop2.lib1_2.fq, results/qc/pop2.lib1_4.fq, results/index/genome, results/qc/pop2.lib1_1.fq, results/raw/genome.fa, results/qc/pop2.lib1_3.fq
    wildcards: population=pop2, library=lib1
    resources: tmpdir=/tmp


        (bwa mem             -M             -R '@RG	ID:pop2_lib1	LB:truseq_lib1	PL:Illumina	SM:pop2'             -t 1                          results/index/genome             results/qc/pop2.lib1_1.fq             results/qc/pop2.lib1_2.fq         | samtools sort             -l 9             -o results/map/raw/pop2.lib1.cram             --reference results/raw/genome.fa             --output-fmt CRAM             -@ 1             /dev/stdin         ) 2> results/map/raw/pop2.lib1.bwa_mem.log
        
Activating conda environment: map
Write-protecting output file results/map/raw/pop2.lib1.cram.
[Wed Jul 12 00:30:37 2023]
Finished job 33.
15 of 72 steps (21%) done
Removing temporary output results/qc/pop2.lib1_1.fq.
Removing temporary output results/qc/pop2.lib1_2.fq.
Removing temporary output results/qc/pop2.lib1_4.fq.
Removing temporary output results/qc/pop2.lib1_3.fq.
Select jobs to execute...

[Wed Jul 12 00:30:37 2023]
rule index_cram:
    input: results/map/raw/pop2.lib1.cram
    output: results/map/raw/pop2.lib1.cram.crai
    jobid: 37
    reason: Missing output files: results/map/raw/pop2.lib1.cram.crai; Input files updated by another job: results/map/raw/pop2.lib1.cram
    wildcards: filename=results/map/raw/pop2.lib1
    resources: tmpdir=/tmp

samtools index results/map/raw/pop2.lib1.cram
Activating conda environment: generic
[Wed Jul 12 00:30:37 2023]
Finished job 37.
16 of 72 steps (22%) done
Select jobs to execute...

[Wed Jul 12 00:30:37 2023]
rule reports_samtools_idxstats:
    input: results/map/raw/pop2.lib1.cram, results/map/raw/pop2.lib1.cram.crai
    output: results/map/raw/pop2.lib1.idxstats.txt
    log: results/map/raw/pop2.lib1.idxstats.log
    jobid: 73
    benchmark: results/map/raw/pop2.lib1.idxstats.bmk
    reason: Missing output files: results/map/raw/pop2.lib1.idxstats.txt; Input files updated by another job: results/map/raw/pop2.lib1.cram, results/map/raw/pop2.lib1.cram.crai
    wildcards: filename=results/map/raw/pop2.lib1
    resources: tmpdir=/tmp

samtools idxstats results/map/raw/pop2.lib1.cram > results/map/raw/pop2.lib1.idxstats.txt 2> results/map/raw/pop2.lib1.idxstats.log
Activating conda environment: reports
[Wed Jul 12 00:30:38 2023]
Finished job 73.
17 of 72 steps (24%) done
Select jobs to execute...

[Wed Jul 12 00:30:38 2023]
rule reports_samtools_stats:
    input: results/map/raw/pop2.lib1.cram
    output: results/map/raw/pop2.lib1.stats.tsv
    log: results/map/raw/pop2.lib1.stats.log
    jobid: 71
    benchmark: results/map/raw/pop2.lib1.stats.bmk
    reason: Missing output files: results/map/raw/pop2.lib1.stats.tsv; Input files updated by another job: results/map/raw/pop2.lib1.cram
    wildcards: filename=results/map/raw/pop2.lib1
    resources: tmpdir=/tmp

samtools stats results/map/raw/pop2.lib1.cram > results/map/raw/pop2.lib1.stats.tsv 2>&1
Activating conda environment: reports
[Wed Jul 12 00:30:41 2023]
Finished job 71.
18 of 72 steps (25%) done
Select jobs to execute...

[Wed Jul 12 00:30:42 2023]
rule reports_samtools_flagstat:
    input: results/map/raw/pop1.lib2.cram
    output: results/map/raw/pop1.lib2.flagstat.txt
    log: results/map/raw/pop1.lib2.flagstat.log
    jobid: 69
    benchmark: results/map/raw/pop1.lib2.flagstat.bmk
    reason: Missing output files: results/map/raw/pop1.lib2.flagstat.txt; Input files updated by another job: results/map/raw/pop1.lib2.cram
    wildcards: filename=results/map/raw/pop1.lib2
    resources: tmpdir=/tmp

samtools flagstat results/map/raw/pop1.lib2.cram > results/map/raw/pop1.lib2.flagstat.txt 2> results/map/raw/pop1.lib2.flagstat.log
Activating conda environment: reports
[Wed Jul 12 00:30:43 2023]
Finished job 69.
19 of 72 steps (26%) done
Select jobs to execute...

[Wed Jul 12 00:30:43 2023]
rule reports_samtools_flagstat:
    input: results/map/raw/pop2.lib1.cram
    output: results/map/raw/pop2.lib1.flagstat.txt
    log: results/map/raw/pop2.lib1.flagstat.log
    jobid: 72
    benchmark: results/map/raw/pop2.lib1.flagstat.bmk
    reason: Missing output files: results/map/raw/pop2.lib1.flagstat.txt; Input files updated by another job: results/map/raw/pop2.lib1.cram
    wildcards: filename=results/map/raw/pop2.lib1
    resources: tmpdir=/tmp

samtools flagstat results/map/raw/pop2.lib1.cram > results/map/raw/pop2.lib1.flagstat.txt 2> results/map/raw/pop2.lib1.flagstat.log
Activating conda environment: reports
[Wed Jul 12 00:30:45 2023]
Finished job 72.
20 of 72 steps (28%) done
Select jobs to execute...

[Wed Jul 12 00:30:45 2023]
rule reports_samtools_stats:
    input: results/map/raw/pop1.lib2.cram
    output: results/map/raw/pop1.lib2.stats.tsv
    log: results/map/raw/pop1.lib2.stats.log
    jobid: 68
    benchmark: results/map/raw/pop1.lib2.stats.bmk
    reason: Missing output files: results/map/raw/pop1.lib2.stats.tsv; Input files updated by another job: results/map/raw/pop1.lib2.cram
    wildcards: filename=results/map/raw/pop1.lib2
    resources: tmpdir=/tmp

samtools stats results/map/raw/pop1.lib2.cram > results/map/raw/pop1.lib2.stats.tsv 2>&1
Activating conda environment: reports
[Wed Jul 12 00:30:48 2023]
Finished job 68.
21 of 72 steps (29%) done
Select jobs to execute...

[Wed Jul 12 00:30:48 2023]
rule map_split:
    input: results/map/raw/pop2.lib1.cram, results/map/raw/pop2.lib1.cram.crai, results/raw/genome.fa
    output: results/map/split/pop2.lib1.2R.bam
    log: results/map/split/pop2.lib1.2R.log
    jobid: 32
    benchmark: results/map/split/pop2.lib1.2R.json
    reason: Missing output files: results/map/split/pop2.lib1.2R.bam; Input files updated by another job: results/raw/genome.fa, results/map/raw/pop2.lib1.cram, results/map/raw/pop2.lib1.cram.crai
    wildcards: population=pop2, library=lib1, chromosome=2R
    resources: tmpdir=/tmp


        samtools view             -u             -T results/raw/genome.fa             -o results/map/split/pop2.lib1.2R.bam             results/map/raw/pop2.lib1.cram             2R         2> results/map/split/pop2.lib1.2R.log
        
Activating conda environment: map
[Wed Jul 12 00:30:48 2023]
Finished job 32.
22 of 72 steps (31%) done
Select jobs to execute...

[Wed Jul 12 00:30:48 2023]
rule map_filter:
    input: results/map/split/pop2.lib1.2R.bam, results/raw/genome.fa
    output: results/map/filt/pop2.lib1.2R.cram, results/map/filt/pop2.lib1.2R.dupstats
    log: results/map/filt/pop2.lib1.2R.log
    jobid: 31
    benchmark: results/map/filt/pop2.lib1.2R.json
    reason: Missing output files: results/map/filt/pop2.lib1.2R.cram; Input files updated by another job: results/map/split/pop2.lib1.2R.bam, results/raw/genome.fa
    wildcards: population=pop2, library=lib1, chromosome=2R
    resources: tmpdir=/tmp, memory_gb=1


        (picard -Xmx1g MarkDuplicates             INPUT=results/map/split/pop2.lib1.2R.bam             OUTPUT=/dev/stdout             METRICS_FILE=results/map/filt/pop2.lib1.2R.dupstats             ASSUME_SORT_ORDER=coordinate             VALIDATION_STRINGENCY=SILENT             COMPRESSION_LEVEL=0             REMOVE_DUPLICATES=true             QUIET=false         | samtools view             -q 20             -f 0x0002  `# read mapped in proper pair. Leave only`             -F 0x0004  `# read unmapped. Throw away`             -F 0x0008  `# mate unmapped. Throw away`             -u             -         | samtools sort             -l 9             -o results/map/filt/pop2.lib1.2R.cram             --reference results/raw/genome.fa             --output-fmt CRAM             /dev/stdin         ) 2> results/map/filt/pop2.lib1.2R.log
        
Activating conda environment: map
Write-protecting output file results/map/filt/pop2.lib1.2R.cram.
[Wed Jul 12 00:31:12 2023]
Finished job 31.
23 of 72 steps (32%) done
Removing temporary output results/map/split/pop2.lib1.2R.bam.
Select jobs to execute...

[Wed Jul 12 00:31:13 2023]
rule mpileup_convert:
    input: results/map/filt/pop2.lib1.2R.cram, results/raw/genome.fa, results/raw/genome.fa.fai
    output: results/mpileup/raw/pop2/pop2.2R.mpileup.gz
    log: results/mpileup/raw/pop2/pop2.2R.log
    jobid: 30
    benchmark: results/mpileup/raw/pop2/pop2.2R.json
    reason: Missing output files: results/mpileup/raw/pop2/pop2.2R.mpileup.gz; Input files updated by another job: results/map/filt/pop2.lib1.2R.cram, results/raw/genome.fa, results/raw/genome.fa.fai
    wildcards: population=pop2, chromosome=2R
    resources: tmpdir=/tmp


        (samtools merge             -u             --reference results/raw/genome.fa             -             results/map/filt/pop2.lib1.2R.cram         | samtools mpileup             -a             --no-BAQ             --min-BQ 0             --fasta-ref results/raw/genome.fa             -         | gzip             --best         > results/mpileup/raw/pop2/pop2.2R.mpileup.gz         ) 2> results/mpileup/raw/pop2/pop2.2R.log
        
Activating conda environment: mpileup
[Wed Jul 12 00:31:26 2023]
Finished job 30.
24 of 72 steps (33%) done
Select jobs to execute...

[Wed Jul 12 00:31:26 2023]
rule mpileup_popoolation_identify_indels:
    input: results/mpileup/raw/pop2/pop2.2R.mpileup.gz
    output: results/mpileup/filt/pop2/pop2.2R.gtf
    log: results/mpileup/filt/pop2/pop2.2R.gtf.log
    jobid: 38
    benchmark: results/mpileup/filt/pop2/pop2.2R.gtf.json
    reason: Missing output files: results/mpileup/filt/pop2/pop2.2R.gtf; Input files updated by another job: results/mpileup/raw/pop2/pop2.2R.mpileup.gz
    wildcards: population=pop2, chromosome=2R
    resources: tmpdir=/tmp


        perl src/popoolation_1.2.2/basic-pipeline/identify-genomic-indel-regions.pl             --input <(gzip --decompress --stdout results/mpileup/raw/pop2/pop2.2R.mpileup.gz)             --output results/mpileup/filt/pop2/pop2.2R.gtf             --indel-window 5             --min-count 2         2>results/mpileup/filt/pop2/pop2.2R.gtf.log 1>&2
        
Activating conda environment: mpileup
[Wed Jul 12 00:31:28 2023]
Finished job 38.
25 of 72 steps (35%) done
Select jobs to execute...

[Wed Jul 12 00:31:28 2023]
rule mpileup_popoolation_filter_indels:
    input: results/mpileup/raw/pop2/pop2.2R.mpileup.gz, results/mpileup/filt/pop2/pop2.2R.gtf
    output: results/mpileup/filt/pop2/pop2.2R.mpileup, results/mpileup/filt/pop2/pop2.2R.mpileup.gz
    log: results/mpileup/filt/pop2/pop2.2R.mpileup.log
    jobid: 29
    benchmark: results/mpileup/filt/pop2/pop2.2R.mpileup.json
    reason: Missing output files: results/mpileup/filt/pop2/pop2.2R.mpileup.gz; Input files updated by another job: results/mpileup/raw/pop2/pop2.2R.mpileup.gz, results/mpileup/filt/pop2/pop2.2R.gtf
    wildcards: population=pop2, chromosome=2R
    resources: tmpdir=/tmp


        mkfifo results/mpileup/filt/pop2/pop2.2R.mpileup

        (cat results/mpileup/filt/pop2/pop2.2R.mpileup | gzip --fast > results/mpileup/filt/pop2/pop2.2R.mpileup.gz &)

        perl src/popoolation_1.2.2/basic-pipeline/filter-pileup-by-gtf.pl             --input <(gzip --decompress --stdout results/mpileup/raw/pop2/pop2.2R.mpileup.gz)             --gtf results/mpileup/filt/pop2/pop2.2R.gtf             --output results/mpileup/filt/pop2/pop2.2R.mpileup         2> results/mpileup/filt/pop2/pop2.2R.mpileup.log 1>&2
        
Activating conda environment: mpileup
[Wed Jul 12 00:31:30 2023]
Finished job 29.
26 of 72 steps (36%) done
Removing temporary output results/mpileup/filt/pop2/pop2.2R.gtf.
Removing temporary output results/mpileup/filt/pop2/pop2.2R.mpileup.
Select jobs to execute...

[Wed Jul 12 00:31:30 2023]
rule mpileup_popoolation_subsample:
    input: results/mpileup/filt/pop2/pop2.2R.mpileup.gz
    output: results/mpileup/sub/pop2/pop2.2R.mpileup, results/mpileup/sub/pop2/pop2.2R.mpileup.gz
    log: results/mpileup/sub/pop2/pop2.2R.log
    jobid: 28
    benchmark: results/mpileup/sub/pop2/pop2.2R.json
    reason: Missing output files: results/mpileup/sub/pop2/pop2.2R.mpileup.gz; Input files updated by another job: results/mpileup/filt/pop2/pop2.2R.mpileup.gz
    wildcards: population=pop2, chromosome=2R
    resources: tmpdir=/tmp


        mkfifo results/mpileup/sub/pop2/pop2.2R.mpileup;

        (cat results/mpileup/sub/pop2/pop2.2R.mpileup | gzip --best > results/mpileup/sub/pop2/pop2.2R.mpileup.gz &)

        perl src/popoolation_1.2.2/basic-pipeline/subsample-pileup.pl             --min-qual 20             --method withoutreplace             --max-coverage 200             --fastq-type sanger             --target-coverage 10             --input <(gzip -dc results/mpileup/filt/pop2/pop2.2R.mpileup.gz)             --output results/mpileup/sub/pop2/pop2.2R.mpileup         2> results/mpileup/sub/pop2/pop2.2R.log 1>&2
        
Activating conda environment: mpileup
Write-protecting output file results/mpileup/sub/pop2/pop2.2R.mpileup.gz.
[Wed Jul 12 00:32:23 2023]
Finished job 28.
27 of 72 steps (38%) done
Removing temporary output results/mpileup/filt/pop2/pop2.2R.mpileup.gz.
Removing temporary output results/mpileup/sub/pop2/pop2.2R.mpileup.
Select jobs to execute...

[Wed Jul 12 00:32:23 2023]
rule popoolation_variance_sliding:
    input: results/mpileup/sub/pop2/pop2.2R.mpileup.gz
    output: results/popoolation/tables/D/pop2.2R.D.snps, results/popoolation/tables/D/pop2.2R.D.tsv
    log: results/popoolation/tables/D/pop2.2R.D.log
    jobid: 27
    benchmark: results/popoolation/tables/D/pop2.2R.D.json
    reason: Missing output files: results/popoolation/tables/D/pop2.2R.D.snps, results/popoolation/tables/D/pop2.2R.D.tsv; Input files updated by another job: results/mpileup/sub/pop2/pop2.2R.mpileup.gz
    wildcards: analysis=D, population=pop2, chromosome=2R
    resources: tmpdir=/tmp


        perl src/popoolation_1.2.2/Variance-sliding.pl             --measure D             --fastq-type sanger             --min-count 2             --min-coverage 4             --max-coverage 200             --min-covered-fraction 0.5             --pool-size 200             --window-size 1000             --step-size 1000             --input <(gzip --decompress --stdout results/mpileup/sub/pop2/pop2.2R.mpileup.gz)             --output results/popoolation/tables/D/pop2.2R.D.tsv             --snp-output results/popoolation/tables/D/pop2.2R.D.snps         2> results/popoolation/tables/D/pop2.2R.D.log 1>&2
        
Activating conda environment: popoolation
[Wed Jul 12 00:32:35 2023]
Finished job 27.
28 of 72 steps (39%) done
Select jobs to execute...

[Wed Jul 12 00:32:35 2023]
rule popoolation_merge_snps:
    input: results/popoolation/tables/D/pop2.2R.D.snps
    output: results/popoolation/plot/D/pop2.D.snps.gz
    jobid: 56
    reason: Missing output files: results/popoolation/plot/D/pop2.D.snps.gz; Input files updated by another job: results/popoolation/tables/D/pop2.2R.D.snps
    wildcards: analysis=D, population=pop2
    resources: tmpdir=/tmp

pigz --processes 1 --best --stdout results/popoolation/tables/D/pop2.2R.D.snps > results/popoolation/plot/D/pop2.D.snps.gz
Activating conda environment: popoolation
Write-protecting output file results/popoolation/plot/D/pop2.D.snps.gz.
[Wed Jul 12 00:32:36 2023]
Finished job 56.
29 of 72 steps (40%) done
Select jobs to execute...

[Wed Jul 12 00:32:36 2023]
rule hp_table_population_chromosome:
    input: results/popoolation/plot/D/pop2.D.snps.gz
    output: results/hp/tables/pop2.tsv.gz
    log: results/hp/tables/pop2.log
    jobid: 55
    benchmark: results/hp/tables/pop2.json
    reason: Missing output files: results/hp/tables/pop2.tsv.gz; Input files updated by another job: results/popoolation/plot/D/pop2.D.snps.gz
    wildcards: population=pop2
    resources: tmpdir=/tmp

(gzip --decompress --stdout results/popoolation/plot/D/pop2.D.snps.gz | python3 src/snps_to_hp.py | pigz --best > results/hp/tables/pop2.tsv.gz) 2> results/hp/tables/pop2.log
Activating conda environment: hp
Write-protecting output file results/hp/tables/pop2.tsv.gz.
[Wed Jul 12 00:32:40 2023]
Finished job 55.
30 of 72 steps (42%) done
Select jobs to execute...

[Wed Jul 12 00:32:40 2023]
rule popoolation_merge_variance_sliding:
    input: results/popoolation/tables/D/pop2.2R.D.tsv
    output: results/popoolation/plot/D/pop2.D.tsv.gz
    log: results/popoolation/plot/D/pop2.D.merge_vs.log
    jobid: 26
    benchmark: results/popoolation/plot/D/pop2.D.merge_vs.json
    reason: Missing output files: results/popoolation/plot/D/pop2.D.tsv.gz; Input files updated by another job: results/popoolation/tables/D/pop2.2R.D.tsv
    wildcards: analysis=D, population=pop2
    resources: tmpdir=/tmp

(bash src/variance_sliding_to_genomic_score.sh results/popoolation/tables/D/pop2.2R.D.tsv | pigz --best --processes 1 > results/popoolation/plot/D/pop2.D.tsv.gz) 2> results/popoolation/plot/D/pop2.D.merge_vs.log
Activating conda environment: popoolation
Write-protecting output file results/popoolation/plot/D/pop2.D.tsv.gz.
[Wed Jul 12 00:32:41 2023]
Finished job 26.
31 of 72 steps (43%) done
Select jobs to execute...

[Wed Jul 12 00:32:41 2023]
rule popoolation_plot:
    input: results/popoolation/plot/D/pop2.D.tsv.gz
    output: results/popoolation/plot/D/pop2.D.pdf
    log: results/popoolation/plot/D/pop2.D.plot.log
    jobid: 25
    benchmark: results/popoolation/plot/D/pop2.D.plot.json
    reason: Missing output files: results/popoolation/plot/D/pop2.D.pdf; Input files updated by another job: results/popoolation/plot/D/pop2.D.tsv.gz
    wildcards: analysis=D, population=pop2
    resources: tmpdir=/tmp


        Rscript src/plot_score.R             --input results/popoolation/plot/D/pop2.D.tsv.gz             --output results/popoolation/plot/D/pop2.D.pdf         2> results/popoolation/plot/D/pop2.D.plot.log
        
Activating conda environment: popoolation
[Wed Jul 12 00:32:43 2023]
Error in rule popoolation_plot:
    jobid: 25
    input: results/popoolation/plot/D/pop2.D.tsv.gz
    output: results/popoolation/plot/D/pop2.D.pdf
    log: results/popoolation/plot/D/pop2.D.plot.log (check log file(s) for error details)
    conda-env: popoolation
    shell:
        
        Rscript src/plot_score.R             --input results/popoolation/plot/D/pop2.D.tsv.gz             --output results/popoolation/plot/D/pop2.D.pdf         2> results/popoolation/plot/D/pop2.D.plot.log
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-07-12T002842.794888.snakemake.log
